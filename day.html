<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adventskalender</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div>
        <h1 id="songQuote"></h1>
        <h2 id="songExplaination"></h2>

        <h3 id="songTitle"></h3>
        <h3 id="songArtist"></h3>

        <div id="songYoutubeContainer">
            <iframe width="inherit"
                    height="inherit"
                    src=""
                    title="YouTube video player"
                    frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    allowfullscreen>
            </iframe>
        </div>
        <div id="songSpotifyContainer">
            <iframe style="border-radius:12px"
                    src=""
                    width="100%"
                    height="152"
                    frameBorder="0"
                    allowfullscreen=""
                    allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
                    loading="lazy">
            </iframe>
        </div>
    </div>


    <script type="module">
        import { getDayFromUrl, getSong, isAllowedDay } from "./js/day.js";
        import { isInDevMode } from "./js/index.js";

        const day = getDayFromUrl();

        if (Number.isNaN(day)) {
            document.querySelector("body").innerHTML = "Error";
            throw Error("No valid day");
        }
        console.log("Selected day is " + day);

        if (!isAllowedDay(day)) {
            const body = document.querySelector("body > div");
            body.innerHTML = "<h1>Um dieses TÃ¼rchen zu Ã¶ffnen, musst du dich noch ein bisschen gedulden ðŸ˜‰</h1>";
            throw Error("Not allowed yet");
        }

        /** @type {Song} */
        const song = getSong(day);

        document.title = "Adventskalender Tag " + day;

        const songQuote = document.getElementById("songQuote");
        const songExplaination = document.getElementById("songExplaination");
        const songTitle = document.getElementById("songTitle");
        const songArtist = document.getElementById("songArtist");
        const songYoutubeContainer = document.getElementById("songYoutubeContainer");
        const songSpotifyContainer = document.getElementById("songSpotifyContainer");

        songQuote.innerText = song.quote;
        songExplaination.innerText = song.explaination;
        songTitle.innerText = song.title;
        songArtist.innerText = song.artist;

        // Only embed the youtube/spotify links if not in dev mode
        if (!isInDevMode()) {
            songYoutubeContainer.querySelector("iframe").src = song.youtubeEmbedLink;
            songSpotifyContainer.querySelector("iframe").src = song.spotifyEmbedLink;
        }
        else {
            songYoutubeContainer.innerHTML = "<div class='YoutubeDev'>Youtube</div>";
            songSpotifyContainer.innerHTML = "<div class='SpotifyDev'>Spotify</div>";
        }

    </script>
</body>
</html>